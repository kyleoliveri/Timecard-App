{"ast":null,"code":"import _objectSpread from \"/Users/KyleOliveri/Desktop/uclaFullStackCoding/Homework/Group-Project-3/timecard-app/client/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _slicedToArray from \"/Users/KyleOliveri/Desktop/uclaFullStackCoding/Homework/Group-Project-3/timecard-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/KyleOliveri/Desktop/uclaFullStackCoding/Homework/Group-Project-3/timecard-app/client/src/components/EditJob/EditJob.js\";\nimport React, { Fragment, useState, useContext, useEffect } from 'react';\nimport AuthContext from '../../context/auth/AuthContext';\nimport setAuthToken from '../../utils/setAuthToken';\nimport Navbar from '../Layout/Navbar/Navbar';\nimport './EditJob.css';\n\nconst EditJob = ({\n  match\n}) => {\n  const authContext = useContext(AuthContext);\n  useEffect(() => {\n    authContext.loadUser();\n    fetchJob(); // eslint-disable-next-line\n  }, []);\n\n  if (localStorage.token) {\n    setAuthToken(localStorage.token);\n  } else {\n    window.location.href = '/';\n  }\n\n  const headers = {\n    'Accept': 'application/json',\n    'Content-Type': 'application/json'\n  };\n  headers['x-auth-token'] = authContext.token;\n  const jid = match.params.id;\n\n  const _useState = useState({\n    name: '',\n    role: '',\n    jobType: '',\n    description: ''\n  }),\n        _useState2 = _slicedToArray(_useState, 2),\n        job = _useState2[0],\n        setJob = _useState2[1];\n\n  const name = job.name,\n        role = job.role,\n        jobType = job.jobType,\n        description = job.description;\n\n  const onChange = e => setJob(_objectSpread({}, job, {\n    [e.target.name]: e.target.value\n  }));\n\n  const fetchJob = () => {\n    //formmatting form responses into payload obj\n    fetch('/api/job/' + jid, {\n      method: 'GET',\n      headers\n    }).then(r => r.json()).then(r => {\n      let res = JSON.stringify(r[0]);\n      setJob(_objectSpread({}, job, {\n        name: r[0].name,\n        role: r[0].role,\n        jobType: r[0].jobType,\n        description: r[0].description\n      }));\n    }).catch(e => console.error('ERROR: ', e));\n  };\n\n  const deleteJob = jid => {\n    var tempArr = [];\n    fetch('/api/timecard/' + jid, {\n      method: 'GET',\n      headers\n    }).then(res => {\n      return res.json();\n    }).then(data => {\n      data.forEach(function (arrayItem) {\n        var x = arrayItem._id;\n        tempArr.push(x);\n      });\n\n      for (let i = 0; i < tempArr.length; i++) {\n        deleteTc(tempArr[i]);\n      }\n    });\n    deleteThisJob(jid);\n  };\n\n  const deleteTc = itemToDelete => {\n    fetch('/api/timecard/' + itemToDelete, {\n      method: 'DELETE',\n      headers\n    }).then(r => r.json()).then(res => {\n      return res;\n    }).then(data => {\n      console.log(data);\n    }).catch(e => console.error('ERROR: ', e));\n  };\n\n  const deleteThisJob = jid => {\n    fetch('/api/job/' + jid, {\n      method: 'DELETE',\n      headers\n    }).then(data => {\n      return data.json();\n    }).then(res => {\n      console.log(res);\n    }).catch(e => console.error('ERROR: ', e));\n  };\n\n  const editJob = obj => {\n    //formmatting form responses into payload obj\n    const headers = {\n      'Accept': 'application/json',\n      'Content-Type': 'application/json'\n    };\n    headers['x-auth-token'] = authContext.token;\n    var newObj = JSON.stringify(obj);\n    fetch('/api/job/' + jid, {\n      method: 'PUT',\n      body: newObj,\n      headers\n    }).then(r => r.json()).then(r => {\n      let res = JSON.stringify(r[0]);\n      console.log(\"this is the second then after editJob fetch \\n                \".concat(res));\n    }).catch(e => console.error('ERROR: ', e));\n  };\n\n  const onSubmit = e => {\n    e.preventDefault();\n\n    var temp = _objectSpread({}, job, {\n      name,\n      role,\n      jobType,\n      description\n    });\n\n    async function temp1() {\n      let response = await editJob(temp);\n      console.log(JSON.stringify(response), \"sucess\");\n      setTimeout(() => {\n        window.location.href = '/';\n      }, 1000);\n    }\n\n    temp1();\n  };\n\n  return React.createElement(Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147\n    },\n    __self: this\n  }, React.createElement(Navbar, {\n    title: \"Edit Job\",\n    dropdown: false,\n    home: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }), React.createElement(\"main\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, React.createElement(\"h5\", {\n    className: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150\n    },\n    __self: this\n  }, \"Job #\", jid), React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"card\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"card-content\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    id: \"title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, \" Add a New Job \"), React.createElement(\"form\", {\n    onSubmit: onSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    id: \"company\",\n    type: \"text\",\n    name: \"name\",\n    placeholder: \"job name\",\n    required: true,\n    value: name,\n    onChange: onChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    id: \"role\",\n    type: \"text\",\n    name: \"role\",\n    placeholder: \"role\",\n    required: true,\n    value: role,\n    onChange: onChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162\n    },\n    __self: this\n  }, React.createElement(\"select\", {\n    className: \"browser-default\",\n    name: \"jobType\",\n    value: jobType,\n    onChange: onChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163\n    },\n    __self: this\n  }, React.createElement(\"option\", {\n    value: \"job\",\n    disabled: true,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 164\n    },\n    __self: this\n  }), React.createElement(\"option\", {\n    value: \"hourly\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, \"Hourly Rate\"), React.createElement(\"option\", {\n    value: \"salary\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, \"Salary/Day Rate\"), React.createElement(\"option\", {\n    value: \"fixed\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167\n    },\n    __self: this\n  }, \"Fixed Project Rate\"))), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    id: \"description\",\n    type: \"text\",\n    name: \"description\",\n    placeholder: \"description\",\n    required: true,\n    value: description,\n    onChange: onChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"submit\",\n    value: \"submit\",\n    id: \"editJob\",\n    className: \"waves-effect waves-light btn\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174\n    },\n    __self: this\n  }, \"Save\"), React.createElement(\"button\", {\n    onClick: () => {\n      deleteJob(jid);\n    },\n    id: \"deleteJob\",\n    className: \"btn waves-effect waves-light\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175\n    },\n    __self: this\n  }, \"Delete\"))))))));\n};\n\nexport default EditJob;","map":{"version":3,"sources":["/Users/KyleOliveri/Desktop/uclaFullStackCoding/Homework/Group-Project-3/timecard-app/client/src/components/EditJob/EditJob.js"],"names":["React","Fragment","useState","useContext","useEffect","AuthContext","setAuthToken","Navbar","EditJob","match","authContext","loadUser","fetchJob","localStorage","token","window","location","href","headers","jid","params","id","name","role","jobType","description","job","setJob","onChange","e","target","value","fetch","method","then","r","json","res","JSON","stringify","catch","console","error","deleteJob","tempArr","data","forEach","arrayItem","x","_id","push","i","length","deleteTc","deleteThisJob","itemToDelete","log","editJob","obj","newObj","body","onSubmit","preventDefault","temp","temp1","response","setTimeout"],"mappings":"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","sourcesContent":["import React, { Fragment, useState, useContext, useEffect } from 'react';\nimport AuthContext from '../../context/auth/AuthContext';\nimport setAuthToken from '../../utils/setAuthToken';\nimport Navbar from '../Layout/Navbar/Navbar';\nimport './EditJob.css';\nconst EditJob = ({ match }) => {\n\n    const authContext = useContext(AuthContext);\n\n    useEffect(() => {\n        authContext.loadUser();\n        fetchJob();\n        // eslint-disable-next-line\n    }, [])\n\n\n    if (localStorage.token) {\n        setAuthToken(localStorage.token);\n    } else {\n        window.location.href = '/';\n    }\n\n    const headers = {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n    }\n    headers['x-auth-token'] = authContext.token;\n\n    const jid = match.params.id;\n\n    const [job, setJob] = useState({\n        name: '',\n        role: '',\n        jobType: '',\n        description: ''\n    });\n\n    const { name, role, jobType, description } = job;\n\n    const onChange = e => setJob({ ...job, [e.target.name]: e.target.value });\n\n    const fetchJob = () => {\n        //formmatting form responses into payload obj\n\n        fetch('/api/job/' + jid, {\n            method: 'GET',\n            headers\n        }).then(r => r.json())\n            .then(r => {\n                let res = JSON.stringify(r[0]);\n                setJob({\n                    ...job,\n                    name: r[0].name,\n                    role: r[0].role,\n                    jobType: r[0].jobType,\n                    description: r[0].description\n                })\n            }).catch(e => console.error('ERROR: ', e));\n    }\n\n    const deleteJob = (jid) => {\n        var tempArr = [];\n        fetch('/api/timecard/' + jid, {\n            method: 'GET',\n            headers\n        }).then(res => {\n            return res.json();\n        }).then(data => {\n            data.forEach(function (arrayItem) {\n                var x = arrayItem._id;\n                tempArr.push(x);\n            });\n            for (let i = 0; i < tempArr.length; i++) {\n                deleteTc(tempArr[i]);\n            }\n        })\n        deleteThisJob(jid);\n    }\n\n    const deleteTc = (itemToDelete) => {\n        fetch('/api/timecard/' + itemToDelete, {\n            method: 'DELETE',\n            headers\n        }).then(r => r.json())\n            .then(res => {\n                return res;\n            }).then(data => {\n                console.log(data)\n            })\n            .catch(e => console.error('ERROR: ', e));\n    }\n\n    const deleteThisJob = (jid) => {\n        fetch('/api/job/' + jid, {\n            method: 'DELETE',\n            headers\n        }).then(data => {\n            return data.json();\n        }).then(res => {\n            console.log(res);\n        }).catch(e => console.error('ERROR: ', e));\n    }\n\n    const editJob = (obj) => {\n        //formmatting form responses into payload obj\n        const headers = {\n            'Accept': 'application/json',\n            'Content-Type': 'application/json',\n        }\n        headers['x-auth-token'] = authContext.token;\n        var newObj = JSON.stringify(obj);\n        fetch('/api/job/' + jid, {\n            method: 'PUT',\n            body: newObj,\n            headers\n        }).then(r => r.json())\n            .then(r => {\n                let res = JSON.stringify(r[0]);\n                console.log(`this is the second then after editJob fetch \n                ${res}`);\n            })\n            .catch(e => console.error('ERROR: ', e));\n    }\n\n    const onSubmit = e => {\n        e.preventDefault();\n        var temp = {\n            ...job,\n            name,\n            role,\n            jobType,\n            description\n        };\n\n        async function temp1() {\n            let response = await editJob(temp);\n            console.log(JSON.stringify(response), \"sucess\")\n            setTimeout(() => {\n                window.location.href = '/';\n            }, 1000);\n\n        }\n        temp1();\n    }\n\n    return (\n        <Fragment>\n            <Navbar title=\"Edit Job\" dropdown={false} home={true} />\n            <main>\n                <h5 className=\"center\">Job #{jid}</h5>\n                <div className=\"container\">\n                    <div className=\"card\">\n                        <div className=\"card-content\">\n                            <div id='title'> Add a New Job </div>\n                            <form onSubmit={onSubmit}>\n                                <div className=\"form-group\">\n                                    <input id=\"company\" type=\"text\" name='name' placeholder=\"job name\" required value={name} onChange={onChange} />\n                                </div>\n                                <div className=\"form-group\">\n                                    <input id=\"role\" type=\"text\" name='role' placeholder=\"role\" required value={role} onChange={onChange} />\n                                </div>\n                                <div className=\"form-group\">\n                                    <select className=\"browser-default\" name='jobType' value={jobType} onChange={onChange}>\n                                        <option value=\"job\" disabled />\n                                        <option value=\"hourly\">Hourly Rate</option>\n                                        <option value=\"salary\">Salary/Day Rate</option>\n                                        <option value=\"fixed\">Fixed Project Rate</option>\n                                    </select>\n                                </div>\n                                <div className=\"form-group\">\n                                    <input id=\"description\" type=\"text\" name='description' placeholder=\"description\" required value={description} onChange={onChange} />\n                                </div>\n                                <div className=\"center\">\n                                    <button type='submit' value='submit' id=\"editJob\" className=\"waves-effect waves-light btn\">Save</button>\n                                    <button onClick={() => { deleteJob(jid) }} id=\"deleteJob\" className=\"btn waves-effect waves-light\">Delete</button>\n                                </div>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n            </main>\n        </Fragment>\n    );\n}\n\nexport default EditJob;"]},"metadata":{},"sourceType":"module"}